import java.awt.*;
import java.io.*;
import java.time.LocalDateTime;
import java.util.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.table.*;

public class Main {
    public static JFrame frame;
    public static ArrayList<Items> items = new ArrayList<>();
    public static DefaultTableModel itemsTableModel;
    public static DefaultTableModel cartTableModel;
    public static JTextField moneyField;
    public static JTextField changeField;
    public static JTextField totalField;
    public static JPasswordField passwordField;
    public static JPanel adminPanel;
    public static JTextField itemNameField, itemPriceField, itemCategoryField, itemQuantityField, itemCodeField, customerIdField, registerCustomerID, registerCustomerName, registerEmployeeID, registerEmployeeName, registerEmployeeBaseSalary;
    public static int currentTotal = 0;
    public static JButton searchButton;
    public static JTextField searchField;
    public static JTable itemsTable;
    private static ArrayList<Customer> customers = new ArrayList<>();
    private static ArrayList<Employee> employees = new ArrayList<>();

    private static final Color PRIMARY_COLOR = new Color(0, 102, 204);
    private static final Color SECONDARY_COLOR = new Color(240, 240, 240);
    private static final Color ACCENT_COLOR = new Color(255, 153, 0);
    private static final Color SUCCESS_COLOR = new Color(0, 153, 51);

    private static JPanel createPanel(String title) {
        JPanel panel = new JPanel(new BorderLayout(10, 10));
        panel.setBorder(new CompoundBorder(
                new TitledBorder(title),
                new EmptyBorder(10, 10, 10, 10))
        );
        panel.setBackground(Color.WHITE);
        return panel;
    }

    private static JTable createStyledTable(DefaultTableModel model) {
        JTable table = new JTable(model);
        table.setFont(new Font("Segoe UI", Font.PLAIN, 14));
        table.setRowHeight(25);
        table.setSelectionBackground(ACCENT_COLOR.brighter());
        table.setSelectionForeground(Color.BLACK);
        table.setGridColor(new Color(220, 220, 220));

        JTableHeader header = table.getTableHeader();
        header.setFont(new Font("Segoe UI", Font.BOLD, 14));
        header.setBackground(PRIMARY_COLOR);
        header.setForeground(Color.WHITE);

        return table;
    }

    private static JButton createStyledButton(String text, Color bgColor) {
        JButton button = new JButton(text);
        button.setFont(new Font("Segoe UI", Font.BOLD, 14));
        button.setBackground(bgColor);
        button.setForeground(Color.WHITE);
        button.setFocusPainted(false);
        button.setBorder(new EmptyBorder(10, 15, 10, 15));
        button.setCursor(new Cursor(Cursor.HAND_CURSOR));
        return button;
    }

    private static JLabel createBoldLabel(String text) {
        JLabel label = new JLabel(text);
        label.setFont(new Font("Segoe UI", Font.BOLD, 14));
        label.setHorizontalAlignment(SwingConstants.RIGHT);
        return label;
    }

    private static JTextField createStyledTextField(String text, boolean editable) {
        JTextField field = new JTextField(text);
        field.setFont(new Font("Segoe UI", Font.PLAIN, 14));
        field.setEditable(editable);
        field.setBorder(BorderFactory.createCompoundBorder(
                BorderFactory.createLineBorder(new Color(200, 200, 200)),
                BorderFactory.createEmptyBorder(5, 5, 5, 5))
        );
        return field;
    }

    private static JTextField createAdminField(String labelText, int x, int y) {
        JLabel label = new JLabel(labelText);
        label.setFont(new Font("Segoe UI", Font.PLAIN, 14));
        label.setBounds(x, y, 200, 25);
        adminPanel.add(label);

        JTextField field = new JTextField();
        field.setFont(new Font("Segoe UI", Font.PLAIN, 14));
        field.setBounds(x + 210, y, 200, 25);
        adminPanel.add(field);

        return field;
    }

    private static void sortItems() {
        Collections.sort(items, (item1, item2) -> {
            int codeCompare = item1.getCode().compareTo(item2.getCode());
            if (codeCompare != 0) return codeCompare;
            return item1.getName().compareTo(item2.getName());
        });
    }

    public static void updateItemsTable(String searchTerm) {
        itemsTableModel.setRowCount(0);
        ArrayList<Items> matchedItems = new ArrayList<>();
        ArrayList<Items> otherItems = new ArrayList<>();

        if (searchTerm != null && !searchTerm.isEmpty()) {
            for (Items item : items) {
                if (item.getCode().toLowerCase().contains(searchTerm.toLowerCase()) ||
                        item.getName().toLowerCase().contains(searchTerm.toLowerCase())) {
                    matchedItems.add(item);
                } else {
                    otherItems.add(item);
                }
            }
        } else {
            otherItems.addAll(items);
        }

        for (Items item : matchedItems) {
            itemsTableModel.addRow(new Object[]{
                    item.getCode(),
                    item.getName(),
                    "$" + item.getPrice() / 100.0,
                    item.getCategory(),
                    item.getQuantity()
            });
        }

        for (Items item : otherItems) {
            itemsTableModel.addRow(new Object[]{
                    item.getCode(),
                    item.getName(),
                    "$" + item.getPrice() / 100.0,
                    item.getCategory(),
                    item.getQuantity()
            });
        }
    }

    public static void addOrUpdateItem() {
        try {
            String code = itemCodeField.getText();
            String name = itemNameField.getText();
            int price = (int) (Double.parseDouble(itemPriceField.getText()) * 100);
            int category = Integer.parseInt(itemCategoryField.getText());
            int quantity = Integer.parseInt(itemQuantityField.getText());

            for (Items item : items) {
                if (item.getCode().equals(code)) {
                    item.setName(name);
                    item.setPrice(price);
                    item.setCategory(category);
                    item.setQuantity(quantity);
                    sortItems();
                    updateItemsTable(null);
                    clearAdminFields();
                    JOptionPane.showMessageDialog(frame, "Item updated successfully!", "Success", JOptionPane.INFORMATION_MESSAGE);
                    return;
                }
            }

            items.add(new Items(name, price, category, quantity, code));
            sortItems();
            updateItemsTable(null);
            clearAdminFields();
            JOptionPane.showMessageDialog(frame, "Item added successfully!", "Success", JOptionPane.INFORMATION_MESSAGE);
        } catch (NumberFormatException e) {
            JOptionPane.showMessageDialog(frame, "Please enter valid numbers for price, category and quantity", "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static void loadItemsFromFile() {
        items.clear();
        try (BufferedReader reader = new BufferedReader(new FileReader("items.txt"))) {
            String line;
            while ((line = reader.readLine()) != null) {
                String[] parts = line.split(",");
                if (parts.length == 5) {
                    items.add(new Items(
                            parts[1],
                            Integer.parseInt(parts[2]),
                            Integer.parseInt(parts[3]),
                            Integer.parseInt(parts[4]),
                            parts[0]
                    ));
                }
            }
            sortItems();
            updateItemsTable(null);
        } catch (FileNotFoundException e) {
            items.add(new Items("Apple", 100, 1, 10, "A001"));
            items.add(new Items("Banana", 50, 1, 15, "A002"));
            items.add(new Items("Milk", 200, 2, 5, "B001"));
            sortItems();
            saveItemsToFile();
            updateItemsTable(null);
            JOptionPane.showMessageDialog(frame, "Created new items file with default items", "Info", JOptionPane.INFORMATION_MESSAGE);
        } catch (IOException e) {
            JOptionPane.showMessageDialog(frame, "Error loading items: " + e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
        } catch (NumberFormatException e) {
            JOptionPane.showMessageDialog(frame, "Error parsing item data", "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static void addToCart(int selectedRow) {
        if (selectedRow >= 0 && selectedRow < itemsTableModel.getRowCount()) {
            String itemCode = (String) itemsTableModel.getValueAt(selectedRow, 0);
            Items item = null;

            for (Items i : items) {
                if (i.getCode().equals(itemCode)) {
                    item = i;
                    break;
                }
            }

            if (item != null) {
                if (item.getQuantity() <= 0) {
                    JOptionPane.showMessageDialog(frame, "Item out of stock!", "Error", JOptionPane.ERROR_MESSAGE);
                    return;
                }

                for (int i = 0; i < cartTableModel.getRowCount(); i++) {
                    if (cartTableModel.getValueAt(i, 0).equals(item.getName())) {
                        int qty = (int) cartTableModel.getValueAt(i, 2) + 1;
                        int total = item.getPrice() * qty;

                        cartTableModel.setValueAt(qty, i, 2);
                        cartTableModel.setValueAt("$" + (total / 100.0), i, 3);

                        item.setQuantity(item.getQuantity() - 1);
                        saveItemsToFile();
                        updateItemsTable(searchField.getText());
                        updateTotal();
                        return;
                    }
                }

                cartTableModel.addRow(new Object[]{
                        item.getName(),
                        "$" + (item.getPrice() / 100.0),
                        1,
                        "$" + (item.getPrice() / 100.0)
                });

                item.setQuantity(item.getQuantity() - 1);
                saveItemsToFile();
                updateItemsTable(searchField.getText());
                updateTotal();
            }
        }
    }

    public static void updateTotal() {
        currentTotal = 0;
        for (int i = 0; i < cartTableModel.getRowCount(); i++) {
            String totalStr = cartTableModel.getValueAt(i, 3).toString().substring(1);
            currentTotal += (int) (Double.parseDouble(totalStr) * 100);
        }
        totalField.setText(String.format("$%.2f", currentTotal / 100.0));
    }

    public static void calculateChange() {
        try {
            String moneyStr = moneyField.getText().replace("$", "");
            double given = Double.parseDouble(moneyStr) * 100;
            double change = given - currentTotal;
            if (change < 0) {
                changeField.setText("$0.00");
                JOptionPane.showMessageDialog(frame,
                        "Insufficient payment!",
                        "Error", JOptionPane.ERROR_MESSAGE);
            } else {
                changeField.setText(String.format("$%.2f", change / 100.0));
            }
        } catch (NumberFormatException e) {
            JOptionPane.showMessageDialog(frame,
                    "Please enter a valid amount",
                    "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static void returnChange(String denomination) {
        try {
            String changeStr = changeField.getText().replace("$", "");
            double change = Double.parseDouble(changeStr) * 100;
            if (change <= 0) {
                return;
            }

            double denomValue = Double.parseDouble(denomination.substring(1)) * 100;
            if (change >= denomValue) {
                int count = (int) (change / denomValue);
                change = change % denomValue;
                changeField.setText(String.format("$%.2f", change / 100.0));
                JOptionPane.showMessageDialog(frame,
                        "Give " + count + " of " + denomination,
                        "Change", JOptionPane.INFORMATION_MESSAGE);
            }
        } catch (NumberFormatException e) {
        }
    }

    public static void toggleAdminPanel() {
        String password = new String(passwordField.getPassword());
        if ("porcusini cocosini".equals(password)) {
            adminPanel.setVisible(!adminPanel.isVisible());
            passwordField.setText("");
            frame.revalidate();
        } else {
            JOptionPane.showMessageDialog(frame, "Incorrect password!", "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static void clearAdminFields() {
        itemCodeField.setText("");
        itemNameField.setText("");
        itemPriceField.setText("");
        itemCategoryField.setText("");
        itemQuantityField.setText("");
    }

    public static void clearPurchases() {
        cartTableModel.setRowCount(0);
        moneyField.setText("");
        changeField.setText("");
        totalField.setText("$0.00");
        currentTotal = 0;
    }

    public static void printReceipt() {
        int receiptNumber = (int) Math.floor(Math.random() * 99999);
        LocalDateTime thisDate = LocalDateTime.now();
        String path = "/home/akaraulanov26/GitHub/" + receiptNumber + ".txt";

        try (FileWriter fw = new FileWriter(path, true)) {
            fw.write("---------------------" + "\n");
            fw.write("Cash receipt id:" + receiptNumber + "\n");
            fw.write("---------------------" + "\n\n");
            fw.write("Adrian's Warehouse    " + "\n" + "    495 Birch Street, NY 10014, USA\n");
            fw.write("Date:      " + thisDate + "\n\n");
            fw.write("---------------------" + "\n");
            fw.write("Items Purchased:" + "\n");
            fw.write("---------------------" + "\n");

            for (int i = 0; i < cartTableModel.getRowCount(); i++) {
                String name = cartTableModel.getValueAt(i, 0).toString();
                String price = cartTableModel.getValueAt(i, 1).toString();
                String quantity = cartTableModel.getValueAt(i, 2).toString();
                String total = cartTableModel.getValueAt(i, 3).toString();

                fw.write(String.format("%-20s %8s %3s %10s%n",
                        name, price, "x" + quantity, total));
            }

            fw.write("\n---------------------" + "\n");
            fw.write(String.format("%-20s %22s%n", "TOTAL:", totalField.getText()));
            fw.write(String.format("%-20s %22s%n", "AMOUNT PAID:", moneyField.getText()));
            fw.write("---------------------" + "\n");
            fw.write("Thank you for shopping with us!" + "\n");
        } catch (IOException e) {
            JOptionPane.showMessageDialog(frame, "Error printing receipt: " + e.getMessage(),
                    "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static void saveItemsToFile() {
        try (PrintWriter writer = new PrintWriter(new FileWriter("items.txt"))) {
            for (Items item : items) {
                writer.println(item.getCode() + "," + item.getName() + "," +
                        item.getPrice() + "," + item.getCategory() + "," +
                        item.getQuantity());
            }
        } catch (IOException e) {
            JOptionPane.showMessageDialog(frame, "Error saving items: " + e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static void saveCustomersToFile(ArrayList<Customer> customers) {
        try (ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("customers.dat"))) {
            oos.writeObject(customers);
        } catch (IOException e) {
            JOptionPane.showMessageDialog(frame, "Error saving customers: " + e.getMessage(),
                    "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static ArrayList<Customer> loadCustomersFromFile() {
        try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream("customers.dat"))) {
            return (ArrayList<Customer>) ois.readObject();
        } catch (FileNotFoundException e) {
            Customer joe1 = new Customer("0","John Doe");
            ArrayList<Customer> customers = new ArrayList<>();
            customers.add(joe1);
            return customers;
        } catch (IOException | ClassNotFoundException e) {
            JOptionPane.showMessageDialog(frame, "Error loading customers: " + e.getMessage(),
                    "Error", JOptionPane.ERROR_MESSAGE);
            return new ArrayList<>();
        }
    }

    public static void saveEmployeesToFile(ArrayList<Employee> employees) {
        try (ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("employees.dat"))) {
            oos.writeObject(employees);
        } catch (IOException e) {
            JOptionPane.showMessageDialog(frame, "Error saving employees: " + e.getMessage(),
                    "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static ArrayList<Employee> loadEmployeesFromFile() {
        try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream("employees.dat"))) {
            return (ArrayList<Employee>) ois.readObject();
        } catch (FileNotFoundException e) {
            Employee joe1 = new Employee("John Doe","0",750);
            ArrayList<Employee> employees = new ArrayList<Employee>();
            employees.add(joe1);
            return employees;
        } catch (IOException | ClassNotFoundException e) {
            JOptionPane.showMessageDialog(frame, "Error loading employees: " + e.getMessage(),
                    "Error", JOptionPane.ERROR_MESSAGE);
            return new ArrayList<>();
        }
    }

    public static void main(String[] args) {
        try {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (Exception e) {
            e.printStackTrace();
        }

        frame = new JFrame("Cash Register System");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(2400, 1600);
        frame.setLayout(new BorderLayout(10, 10));
        frame.getContentPane().setBackground(SECONDARY_COLOR);

        JPanel mainPanel = new JPanel(new BorderLayout(20, 20));
        mainPanel.setBorder(new EmptyBorder(20, 20, 20, 20));
        mainPanel.setBackground(SECONDARY_COLOR);
        frame.add(mainPanel, BorderLayout.CENTER);

        JPanel headerPanel = new JPanel();
        headerPanel.setBackground(PRIMARY_COLOR);
        JLabel titleLabel = new JLabel("CASH REGISTER SYSTEM", SwingConstants.CENTER);
        titleLabel.setFont(new Font("Segoe UI", Font.BOLD, 28));
        titleLabel.setForeground(Color.WHITE);
        headerPanel.add(titleLabel);
        mainPanel.add(headerPanel, BorderLayout.NORTH);

        JPanel centerPanel = new JPanel(new GridLayout(1, 3, 20, 0));
        centerPanel.setBackground(SECONDARY_COLOR);
        mainPanel.add(centerPanel, BorderLayout.CENTER);

        JPanel leftPanel = createPanel("Available Items");
        String[] itemColumns = {"Code", "Name", "Price", "Category", "Quantity"};
        itemsTableModel = new DefaultTableModel(itemColumns, 0) {
            @Override
            public boolean isCellEditable(int row, int column) {
                return false;
            }
        };
        itemsTable = createStyledTable(itemsTableModel);
        updateItemsTable(null);

        JScrollPane itemsScrollPane = new JScrollPane(itemsTable);
        itemsScrollPane.setPreferredSize(new Dimension(400, 600));
        leftPanel.add(itemsScrollPane, BorderLayout.CENTER);

        JButton addToCartButton = createStyledButton("Add to Cart", ACCENT_COLOR);
        addToCartButton.addActionListener(e -> addToCart(itemsTable.getSelectedRow()));

        JPanel searchPanel = createPanel("Search");
        searchPanel.setLayout(new BorderLayout(10, 10));
        searchField = createStyledTextField("Search by ID", true);
        searchButton = createStyledButton("Go", ACCENT_COLOR);

        searchButton.addActionListener(e -> {
            String searchTerm = searchField.getText();
            updateItemsTable(searchTerm);

            if (itemsTableModel.getRowCount() > 0) {
                itemsTable.scrollRectToVisible(itemsTable.getCellRect(0, 0, true));
            }
        });

        searchPanel.add(searchField, BorderLayout.CENTER);
        searchPanel.add(searchButton, BorderLayout.EAST);
        leftPanel.add(searchPanel, BorderLayout.SOUTH);
        leftPanel.add(addToCartButton, BorderLayout.EAST);
        centerPanel.add(leftPanel);

        JPanel middlePanel = createPanel("Shopping Cart");
        middlePanel.setLayout(new BorderLayout(10, 10));

        String[] cartColumns = {"Item", "Price", "Quantity", "Total"};
        cartTableModel = new DefaultTableModel(cartColumns, 0) {
            @Override
            public boolean isCellEditable(int row, int column) {
                return false;
            }
        };
        JTable cartTable = createStyledTable(cartTableModel);
        JScrollPane cartScrollPane = new JScrollPane(cartTable);
        middlePanel.add(cartScrollPane, BorderLayout.CENTER);

        JPanel totalsPanel = new JPanel(new GridLayout(4, 2, 10, 10));
        totalsPanel.setBorder(new EmptyBorder(10, 10, 10, 10));
        totalsPanel.setBackground(Color.WHITE);

        JLabel totalLabel = createBoldLabel("Total:");
        totalField = createStyledTextField("0", false);
        JLabel moneyLabel = createBoldLabel("Amount Given:");
        moneyField = createStyledTextField("", true);
        JLabel changeLabel = createBoldLabel("Change Due:");
        changeField = createStyledTextField("0", false);
        JLabel enterCustomerId = createBoldLabel("Customer ID:");
        customerIdField = createStyledTextField("ID",true);
        totalsPanel.add(totalLabel);
        totalsPanel.add(totalField);
        totalsPanel.add(moneyLabel);
        totalsPanel.add(moneyField);
        totalsPanel.add(changeLabel);
        totalsPanel.add(changeField);
        totalsPanel.add(enterCustomerId);
        totalsPanel.add(customerIdField);
        middlePanel.add(totalsPanel, BorderLayout.NORTH);

        JPanel buttonsPanel = new JPanel(new GridLayout(3, 1, 10, 10));
        buttonsPanel.setBorder(new EmptyBorder(10, 10, 10, 10));
        buttonsPanel.setBackground(Color.WHITE);

        JButton calculateChangeButton = createStyledButton("Calculate Change", PRIMARY_COLOR);
        calculateChangeButton.addActionListener(e -> calculateChange());
        buttonsPanel.add(calculateChangeButton);

        JPanel roundPanel = new JPanel(new GridLayout(1, 1, 10, 0));
        roundPanel.setBackground(Color.WHITE);
        JButton round50Button = createStyledButton("Complete Purchase", PRIMARY_COLOR);
        round50Button.addActionListener(e -> {
            if (cartTableModel.getRowCount() > 0) {
                printReceipt();
                clearPurchases();
            } else {
                JOptionPane.showMessageDialog(frame, "Cart is empty!", "Error", JOptionPane.ERROR_MESSAGE);
            }
        });

        roundPanel.add(round50Button);
        buttonsPanel.add(roundPanel);

        JPanel changeButtonsPanel = new JPanel(new GridLayout(2, 4, 5, 5));
        changeButtonsPanel.setBackground(Color.WHITE);
        String[] denominations = {"$0.01", "$0.05", "$0.25", "$0.5", "$1", "$5", "$10", "$20", "$50", "$100"};
        for (String denom : denominations) {
            JButton btn = createStyledButton(denom, ACCENT_COLOR);
            btn.addActionListener(e -> returnChange(denom));
            changeButtonsPanel.add(btn);
        }
        buttonsPanel.add(changeButtonsPanel);
        middlePanel.add(buttonsPanel, BorderLayout.SOUTH);
        centerPanel.add(middlePanel);

        JPanel rightPanel = createPanel("Administration");
        rightPanel.setLayout(new BorderLayout(10, 10));

        JPanel passwordPanel = new JPanel(new BorderLayout(10, 10));
        passwordPanel.setBorder(new EmptyBorder(10, 10, 10, 10));
        passwordPanel.setBackground(Color.WHITE);
        JLabel passwordLabel = createBoldLabel("Admin Password:");
        passwordField = new JPasswordField();
        passwordField.setFont(new Font("Segoe UI", Font.PLAIN, 14));
        JButton loginButton = createStyledButton("Login", PRIMARY_COLOR);
        loginButton.addActionListener(e -> toggleAdminPanel());
        passwordPanel.add(passwordLabel, BorderLayout.NORTH);
        passwordPanel.add(passwordField, BorderLayout.CENTER);
        passwordPanel.add(loginButton, BorderLayout.SOUTH);
        rightPanel.add(passwordPanel, BorderLayout.NORTH);

        adminPanel = new JPanel(null);
        adminPanel.setBorder(new CompoundBorder(
                new TitledBorder("Admin Controls"),
                new EmptyBorder(10, 10, 10, 10))
        );
        adminPanel.setBackground(Color.WHITE);
        adminPanel.setVisible(false);

        int yPos = 30;
        itemCodeField = createAdminField("Item Code:", 20, yPos);
        yPos += 50;
        itemNameField = createAdminField("Name:", 20, yPos);
        yPos += 50;
        itemPriceField = createAdminField("Price:", 20, yPos);
        yPos += 50;
        itemCategoryField = createAdminField("Category:", 20, yPos);
        yPos += 50;
        itemQuantityField = createAdminField("Quantity:", 20, yPos);
        yPos += 50;
        registerCustomerID = createAdminField("Enter new customer ID:",20,yPos);
        yPos += 50;
        registerCustomerName = createAdminField("Enter new customer name:",20,yPos);
        yPos += 50;
        registerEmployeeID = createAdminField("Enter new customer ID:",20,yPos);
        yPos += 50;
        registerEmployeeName = createAdminField("Enter new customer name:",20,yPos);
        yPos += 50;
        registerEmployeeBaseSalary = createAdminField("Enter new customer base-salary:",20,yPos);
        yPos += 50;
        JButton registerCustomerButton = createStyledButton("Register Customer", SUCCESS_COLOR);
        registerCustomerButton.setBounds(240, yPos, 200, 40);
        registerCustomerButton.addActionListener(e -> {
            String customerID = registerCustomerID.getText();
            String customerName = registerCustomerName.getText();

            if (!customerID.isEmpty() && !customerName.isEmpty()) {
                customers.add(new Customer(customerID, customerName));
                saveCustomersToFile(customers);
                
                registerCustomerID.setText("");
                registerCustomerName.setText("");
            }
        });
        
        adminPanel.add(registerCustomerButton);
        yPos += 50;
        JButton registerEmployeeButton = createStyledButton("Register Employee", SUCCESS_COLOR);
        registerEmployeeButton.setBounds(440, yPos, 200, 40);
        registerEmployeeButton.addActionListener(e -> {
            String employeeID = registerEmployeeID.getText();
            String employeeName = registerEmployeeName.getText();
            double employeeBaseSalary = Double.parseDouble(registerEmployeeBaseSalary.getText());
            if(!employeeName.isEmpty() && !employeeID.isEmpty() && employeeBaseSalary != 0){
                employees.add(new Employee(employeeName,employeeID,employeeBaseSalary));
                saveEmployeesToFile(employees);
                registerEmployeeID.setText("");
                registerEmployeeName.setText("");
                registerEmployeeBaseSalary.setText("");
            }
        });
        JButton saveAndInsertButton = createStyledButton("Add/Save Item", SUCCESS_COLOR);
        saveAndInsertButton.setBounds(20, yPos, 200, 40);
        saveAndInsertButton.addActionListener(e -> {
            addOrUpdateItem();
            saveItemsToFile();
        });
        adminPanel.add(saveAndInsertButton);

        rightPanel.add(adminPanel, BorderLayout.CENTER);
        centerPanel.add(rightPanel);
        loadItemsFromFile();
        customers = loadCustomersFromFile();
        employees = loadEmployeesFromFile();
        frame.setVisible(true);
    }
}

class Items {
    private String name;
    private int price;
    private int category;
    private int quantity;
    private String code;

    public Items(String name, int price, int category, int quantity, String code) {
        this.name = name;
        this.price = price;
        this.category = category;
        this.quantity = quantity;
        this.code = code;
    }

    public String getName() {
        return name;
    }

    public int getPrice() {
        return price;
    }

    public int getCategory() {
        return category;
    }

    public int getQuantity() {
        return quantity;
    }

    public String getCode() {
        return code;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setPrice(int price) {
        this.price = price;
    }

    public void setCategory(int category) {
        this.category = category;
    }

    public void setQuantity(int quantity) {
        this.quantity = quantity;
    }
}

class Employee implements Serializable {
    private static final long serialVersionUID = 1L;
    private String name;
    private double baseSalary;
    private int sales;
    private String employeeID;

    public Employee(String name, String employeeID, double baseSalary) {
        this.name = name;
        this.employeeID = employeeID;
        this.baseSalary = baseSalary;
        this.sales = 0;
    }

    public String getName() {
        return name;
    }

    public String getEmployeeID() {
        return employeeID;
    }

    public int getSales() {
        return sales;
    }

    public void addSale(int amount) {
        this.sales += amount;
    }

    public double calculateBonus() {
        if (sales <= 50000) {
            return 0.0; // No bonus
        } else if (sales <= 65000) {
            return baseSalary * 0.1;
        } else if (sales <= 90000) {
            return baseSalary * 0.2;
        } else {
            return baseSalary * 0.3;
        }
    }

    public double getTotalSalary() {
        return baseSalary + calculateBonus();
    }

    public String toString() {
        return String.format("Employee[ID=%s, Name=%s, Sales=$%d, Salary=$%.2f]",
                employeeID, name, sales, getTotalSalary());
    }
}

class Customer implements Serializable {
    private static final long serialVersionUID = 1L;
    private String ID;
    private String name;
    private double purchases;
    private int rewardPoints;

    public Customer(String ID, String name) {
        this.ID = ID;
        this.name = name;
        this.purchases = 0;
        this.rewardPoints = 0;
    }

    public String getID() {
        return ID;
    }

    public String getName() {
        return name;
    }

    public double getPurchases() {
        return purchases;
    }

    public int getRewardPoints() {
        return rewardPoints;
    }

    public void addPurchase(double amount) {
        this.purchases += amount;
        this.rewardPoints += (int)(amount * calculateRewardMultiplier());
    }

    private double calculateRewardMultiplier() {
        if (purchases <= 300) {
            return 0.01;
        } else if (purchases <= 500) {
            return 0.02;
        } else if (purchases <= 750) {
            return 0.03;
        } else {
            return 0.05;
        }
    }

    public String toString() {
        return String.format("Customer[ID=%s, Name=%s, TotalPurchases=$%.2f, RewardPoints=%d]",
                ID, name, purchases, rewardPoints);
    }
}
